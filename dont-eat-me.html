
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Please don’t eat me - Lab &#8212; Explorations!?</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Be best - Lab" href="be-best.html" />
    <link rel="prev" title="The Air Quotes Cognition - Lab" href="air-quotes.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Explorations!?</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="python.html">
   Introduction to python - Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="explorationlib.html">
   Introduction to
   <em>
    explorationlib
   </em>
   - Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="therunaround.html">
   The Runaround - Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sniff%21.html">
   The Sniff! - Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="air-quotes.html">
   The Air Quotes Cognition - Lab
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Please don’t eat me - Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="be-best.html">
   Be best - Lab
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/dont-eat-me.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/parenthetical-e/explorations-book/main?urlpath=tree/book/dont-eat-me.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/parenthetical-e/explorations-book/blob/main/book/dont-eat-me.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-and-import-needed-modules">
   Install and import needed modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-a-lone-and-hungry-coyote">
   Section 1 - a lone and hungry coyote
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-base-case">
     The base case
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-1">
       Question 1.1
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples">
     Examples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis">
     Analysis
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-2">
       Question 1.2
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eagle-eyes">
     Eagle eyes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-3">
       Question 1.3
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-5">
       Question 1.5
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-fast-and-the">
     The fast and the….
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-6">
       Question 1.6
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-7">
       Question 1.7
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#range-anxiety">
     Range anxiety
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-8">
       Question 1.8
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-9">
       Question 1.9
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hunting-buddies">
     Hunting buddies
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-10">
       Question 1.10
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-11">
       Question 1.11
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#no-one-can-see-me">
     No one can see me!?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-12">
       Question 1.12
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#question-1-13">
       Question 1.13
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-life-is-in-your-hands-now">
   Section 2 - Life is in your hands now….
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-2-1">
     Question 2.1
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="please-don-t-eat-me-lab">
<h1>Please don’t eat me - Lab<a class="headerlink" href="#please-don-t-eat-me-lab" title="Permalink to this headline">¶</a></h1>
<p>In this assignment we study exploration for targets that can move. Prey, in other words. We also add uncertainty to their capture, with a probability of escape term, <em>p escape</em>. Think of this as a successful fleeing.</p>
<p>Our exploration strategies are once again random. We have no scent or memory as an aide.</p>
<p>The world is a grid world.</p>
<p>The lab has two sections.</p>
<ul class="simple">
<li><p><em>First</em> is a demo mostly. We will explore speed, scale, detection, predator number, and escape. Here we have one predator (our explorer) and one prey (our target), well mostly.</p></li>
<li><p><em>Second</em>, is where things get more interesting. We’ll change the venue. Make it bigger. Add more prey, and of different species. I’ll then award you with 10 “evolution points’’ that you can spend by increasing the number of predators, their speed, their movement scale, or their vision.</p></li>
</ul>
<p>Our metrics are metrics of death. We use two, but our focus is on their difference.</p>
<ul class="simple">
<li><p><em>Predator deaths</em>: Any experimental trial which does not lead to finding at least a single target (aka reward or prey) means the exploring agent (predator) dies. It’s a harsh noisy world we live in, after all.</p></li>
<li><p><em>Prey deaths</em>: The number of prey deaths is the number of targets found, which is the same as the number of rewards observed. However unlike past exploration tasks, once a prey (target) has been found it is removed from the field, and stays dead for the rest of that experiment. When the experiment resets, for each <em>num experiment</em>, all the targets spring back to life and the predator(s) get another chance.</p></li>
<li><p><em>Prey deaths - Predator deaths</em>: We’ll call this last value, the difference between deaths, the <em>fitness score</em>. More positive values are better. More negative values are worse.</p></li>
</ul>
<div class="section" id="install-and-import-needed-modules">
<h2>Install and import needed modules<a class="headerlink" href="#install-and-import-needed-modules" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install explorationlib?</span>
<span class="o">!</span>pip install --upgrade git+https://github.com/parenthetical-e/explorationlib
<span class="o">!</span>pip install --upgrade git+https://github.com/MattChanTK/gym-maze.git
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">explorationlib</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">DiffusionGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">LevyGrid</span>
<span class="kn">from</span> <span class="nn">explorationlib.agent</span> <span class="kn">import</span> <span class="n">FreezeLevyGrid</span>

<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">uniform_targets</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">constant_values</span>
<span class="kn">from</span> <span class="nn">explorationlib.local_gym</span> <span class="kn">import</span> <span class="n">CompetitiveGrid</span>

<span class="kn">from</span> <span class="nn">explorationlib.run</span> <span class="kn">import</span> <span class="n">multi_experiment</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">select_exp</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">select_agent</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">load</span>
<span class="kn">from</span> <span class="nn">explorationlib.util</span> <span class="kn">import</span> <span class="n">save</span>

<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_position2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_positions2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_length_hist</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_length</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">plot_targets2d</span>
<span class="kn">from</span> <span class="nn">explorationlib.plot</span> <span class="kn">import</span> <span class="n">show_gif</span>

<span class="kn">from</span> <span class="nn">explorationlib</span> <span class="kn">import</span> <span class="n">score</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">num_death</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">average_reward</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">total_reward</span>
<span class="kn">from</span> <span class="nn">explorationlib.score</span> <span class="kn">import</span> <span class="n">first_reward</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pretty plots</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format=&#39;retina&#39;
<span class="o">%</span><span class="k">config</span> IPCompleter.greedy=True
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;16&quot;</span>

<span class="c1"># Dev</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-1-a-lone-and-hungry-coyote">
<h2>Section 1 - a lone and hungry coyote<a class="headerlink" href="#section-1-a-lone-and-hungry-coyote" title="Permalink to this headline">¶</a></h2>
<p>In this section we’ll study one explorer (predator) and one target (prey) noisy, as a base case. Both will be diffusion models, to start with anyway. They will start with the same movement scale, detection radius and speed. From there we’ll try some changes, to see what helps predators and <em>how much it helps.</em> We’ll see what helps the prey, and <em>how much</em>.</p>
<div class="section" id="the-base-case">
<h3>The base case<a class="headerlink" href="#the-base-case" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shared env params</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">num_experiments</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">seed_value</span> <span class="o">=</span> <span class="mi">559</span>

<span class="n">num_agents</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_targets</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">target_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">))</span>

<span class="n">detection_radius</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p_target</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p_escape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_target</span><span class="p">)</span>

<span class="n">target_boundary</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">step_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">min_length</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">detection_radius</span> <span class="o">=</span>  <span class="mi">1</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Create env </span>
<span class="n">prng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CompetitiveGrid</span><span class="p">(</span><span class="n">num_agents</span><span class="o">=</span><span class="n">num_agents</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">uniform_targets</span><span class="p">(</span><span class="n">num_targets</span><span class="p">,</span> <span class="n">target_boundary</span><span class="p">,</span> <span class="n">prng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">constant_values</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="question-1-1">
<h4>Question 1.1<a class="headerlink" href="#question-1-1" title="Permalink to this headline">¶</a></h4>
<p>We start with an equal match, scale, speed, number, on a small domain, with a detection radius that’s about 10 percent of the domain. Make a guess. Will the fitness score be a positive number on average, or a negative one? Explain yourself.</p>
<p>That is, does it even make sense to hunt alone when you don’t have any advantage?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. </span>
</pre></div>
</div>
</div>
</div>
<p>Let’s see if you were right</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Intial targets</span>
<span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
    <span class="n">target_index</span><span class="p">,</span> 
    <span class="n">targets</span><span class="p">,</span> 
    <span class="n">values</span><span class="p">,</span> 
    <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
    <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
<span class="p">)</span>

<span class="c1"># Preds</span>
<span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
        <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
        <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Preys</span>
<span class="n">prey</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
        <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
        <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span> 

<span class="c1"># All agents</span>
<span class="n">agents</span> <span class="o">=</span> <span class="n">prey</span> <span class="o">+</span> <span class="n">pred</span>

<span class="c1"># !</span>
<span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;base&quot;</span><span class="p">,</span>
    <span class="n">agents</span><span class="p">,</span> 
    <span class="n">env</span><span class="p">,</span>
    <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
    <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
    <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># -</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prey index : </span><span class="si">{target_index}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>Plot 5 example experiments of a predator search, prey evasion. Both are random walks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_boundary</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1"># Example bout</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_positions2d</span><span class="p">(</span>
        <span class="n">select_exp</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span>
        <span class="n">num_agents</span><span class="p">,</span>
        <span class="n">boundary</span><span class="o">=</span><span class="n">plot_boundary</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Prey</span><span class="si">{n}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">target_index</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Pred&quot;</span><span class="p">],</span>
        <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_targets2d</span><span class="p">(</span>
        <span class="n">env</span><span class="p">,</span>
        <span class="n">boundary</span><span class="o">=</span><span class="n">plot_boundary</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Intial target&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="question-1-2">
<h4>Question 1.2<a class="headerlink" href="#question-1-2" title="Permalink to this headline">¶</a></h4>
<p>Was you answer to Q 1.1 correct? Were you close? If you were wrong, or way off, please try an explain why. In what way did your intuition betray you?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="eagle-eyes">
<h3>Eagle eyes<a class="headerlink" href="#eagle-eyes" title="Permalink to this headline">¶</a></h3>
<p>Here we will increase the detection radius up to five fold.</p>
<div class="section" id="question-1-3">
<h4>Question 1.3<a class="headerlink" href="#question-1-3" title="Permalink to this headline">¶</a></h4>
<p>Make a guess. Will linear increases in vision (aka detection radius) give our predator a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detection_radii</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detection_radii</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">detection_radii</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;vision_</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-1-5">
<h4>Question 1.5<a class="headerlink" href="#question-1-5" title="Permalink to this headline">¶</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="the-fast-and-the">
<h3>The fast and the….<a class="headerlink" href="#the-fast-and-the" title="Permalink to this headline">¶</a></h3>
<p>Here we will increase the step size of the predator up to five fold. This is akin to increasing its speed relative to the target.</p>
<div class="section" id="question-1-6">
<h4>Question 1.6<a class="headerlink" href="#question-1-6" title="Permalink to this headline">¶</a></h4>
<p>Make a guess. Will linear increases in speed (aka step size) give our predator a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_step_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_step_sizes</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">target_step_sizes</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">x</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;speed_</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---</span>
<span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-1-7">
<h4>Question 1.7<a class="headerlink" href="#question-1-7" title="Permalink to this headline">¶</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as a comment. Explain yourself</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="range-anxiety">
<h3>Range anxiety<a class="headerlink" href="#range-anxiety" title="Permalink to this headline">¶</a></h3>
<p>Here we will increase the range/scale of the predator up to five fold. This is akin to increasing how far it will travel in a fixed time interval.</p>
<div class="section" id="question-1-8">
<h4>Question 1.8<a class="headerlink" href="#question-1-8" title="Permalink to this headline">¶</a></h4>
<p>Make a guess. Will linear increases in exploration range (aka scale) give our predator a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as a comment. Explain yourself</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_scales</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_scales</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">pred_scales</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;scale_</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---</span>
<span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-1-9">
<h4>Question 1.9<a class="headerlink" href="#question-1-9" title="Permalink to this headline">¶</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="hunting-buddies">
<h3>Hunting buddies<a class="headerlink" href="#hunting-buddies" title="Permalink to this headline">¶</a></h3>
<p>Will aadding more predators help? If, that is, everything else is the same as our base case.</p>
<div class="section" id="question-1-10">
<h4>Question 1.10<a class="headerlink" href="#question-1-10" title="Permalink to this headline">¶</a></h4>
<p>Make a guess. Will linear increases in predators give a linear improvement in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_predators</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_predators</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">num_predators</span><span class="p">):</span>
    <span class="n">x_num_agents</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>
    <span class="n">x_num_targets</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">x_target_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_num_targets</span><span class="p">))</span>

    <span class="c1"># Create env </span>
    <span class="n">x_env</span> <span class="o">=</span> <span class="n">CompetitiveGrid</span><span class="p">(</span><span class="n">num_agents</span><span class="o">=</span><span class="n">x_num_agents</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">uniform_targets</span><span class="p">(</span><span class="n">x_num_targets</span><span class="p">,</span> <span class="n">target_boundary</span><span class="p">,</span> <span class="n">prng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
    <span class="n">x_values</span> <span class="o">=</span> <span class="n">constant_values</span><span class="p">(</span><span class="n">x_targets</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Intial targets</span>
    <span class="n">x_env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">x_target_index</span><span class="p">,</span> 
        <span class="n">x_targets</span><span class="p">,</span> 
        <span class="n">x_values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> <span class="o">*</span> <span class="n">x</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;pred_</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">x_env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-1-11">
<h4>Question 1.11<a class="headerlink" href="#question-1-11" title="Permalink to this headline">¶</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="no-one-can-see-me">
<h3>No one can see me!?<a class="headerlink" href="#no-one-can-see-me" title="Permalink to this headline">¶</a></h3>
<p>Here we will increase the prey’s ability to escape, <em>p escape</em>.</p>
<div class="section" id="question-1-12">
<h4>Question 1.12<a class="headerlink" href="#question-1-12" title="Permalink to this headline">¶</a></h4>
<p>Make a guess. Will linear increases to p escape give a linear decrease in fitness value, for this particular task and prey starting location?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_escapes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_escapes</span><span class="p">)))</span>

<span class="c1"># !</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">p_escapes</span><span class="p">):</span>
    <span class="c1"># Intial targets</span>
    <span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
        <span class="n">target_index</span><span class="p">,</span> 
        <span class="n">targets</span><span class="p">,</span> 
        <span class="n">values</span><span class="p">,</span> 
        <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
        <span class="n">p_target</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Preds</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Preys</span>
    <span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DiffusionGrid</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
            <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
            <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
        <span class="p">)</span>
    <span class="p">]</span> 

    <span class="c1"># All agents</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">pred</span>

    <span class="c1"># !</span>
    <span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;escape_</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
        <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
        <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">pred_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pred death&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">prey_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Prey deaths&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">num_experiments</span><span class="p">,</span> <span class="n">num_experiments</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-1-13">
<h4>Question 1.13<a class="headerlink" href="#question-1-13" title="Permalink to this headline">¶</a></h4>
<p>Was your answer to the last question correct? If it was not, hypothesize why that was.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here as comment. Explain yourself.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-2-life-is-in-your-hands-now">
<h2>Section 2 - Life is in your hands now….<a class="headerlink" href="#section-2-life-is-in-your-hands-now" title="Permalink to this headline">¶</a></h2>
<p>In this section you will be given 10 “evolution points”. They can spent on step size, scale, num_predators. The domain is now bigger, and the are 12 prey of three different “species”.</p>
<div class="section" id="question-2-1">
<h3>Question 2.1<a class="headerlink" href="#question-2-1" title="Permalink to this headline">¶</a></h3>
<p>In this section spend your 10 points as you see fit. Try and find the best fitness you can. Do not change any parameters but the four below. I am grading you on your process, not on the final result. Show me each thing you try, in a new cell. Add a comment to the top of each one as to why you tried that set of numbers.</p>
<p>(If it is a wild guess to start that is fine. Refine your thinking as you go.)</p>
<p><em>Note 1:</em> If you go over 10, expect strong deductions.</p>
<p><em>Note 2:</em> If you max out fitness, then you win a prize (TBD)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Explain your hypothesis/guess here....</span>


<span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Spend here ONLY (count the points carefully)</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">detection_radius</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">step_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_predators</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Run</span>
<span class="n">min_length</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">preys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Fast</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
    <span class="c1"># Flight</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">LevyGrid</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="c1"># Freeze</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">),</span>
    <span class="n">FreezeLevyGrid</span><span class="p">(</span><span class="n">p_freeze</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span><span class="p">)</span>
<span class="p">]</span> 

<span class="c1"># Shared env params</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">num_experiments</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">seed_value</span> <span class="o">=</span> <span class="mi">559</span>

<span class="n">num_targets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">preys</span><span class="p">)</span>
<span class="n">target_index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">))</span>
<span class="n">num_agents</span> <span class="o">=</span> <span class="n">num_predators</span> <span class="o">+</span> <span class="n">num_targets</span>

<span class="n">p_target</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">target_boundary</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Create env </span>
<span class="n">prng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CompetitiveGrid</span><span class="p">(</span><span class="n">num_agents</span><span class="o">=</span><span class="n">num_agents</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">uniform_targets</span><span class="p">(</span><span class="n">num_targets</span><span class="p">,</span> <span class="n">target_boundary</span><span class="p">,</span> <span class="n">prng</span><span class="o">=</span><span class="n">prng</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">constant_values</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Run</span>
<span class="n">model_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Intial targets</span>
<span class="n">env</span><span class="o">.</span><span class="n">add_targets</span><span class="p">(</span>
    <span class="n">target_index</span><span class="p">,</span> 
    <span class="n">targets</span><span class="p">,</span> 
    <span class="n">values</span><span class="p">,</span> 
    <span class="n">detection_radius</span><span class="o">=</span><span class="n">detection_radius</span><span class="p">,</span> 
    <span class="n">p_target</span><span class="o">=</span><span class="n">p_target</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Preds</span>
<span class="n">preds</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DiffusionGrid</span><span class="p">(</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> 
        <span class="n">min_length</span><span class="o">=</span><span class="n">min_length</span><span class="p">,</span> 
        <span class="n">step_size</span><span class="o">=</span><span class="n">step_size</span>
    <span class="p">)</span>
<span class="p">]</span> <span class="o">*</span> <span class="n">num_predators</span>

<span class="c1"># All agents</span>
<span class="n">agents</span> <span class="o">=</span> <span class="n">preys</span> <span class="o">+</span> <span class="n">preds</span>

<span class="c1"># !</span>
<span class="n">comp_exp</span> <span class="o">=</span> <span class="n">multi_experiment</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;oracle&quot;</span><span class="p">,</span>
    <span class="n">agents</span><span class="p">,</span> 
    <span class="n">env</span><span class="p">,</span>
    <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">,</span>
    <span class="n">num_experiments</span><span class="o">=</span><span class="n">num_experiments</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">seed_value</span><span class="p">,</span>
    <span class="n">split_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">dump</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_exp</span><span class="p">)</span>

<span class="c1"># ---------------------------------------------------------------------------------</span>
<span class="c1"># Est. death</span>
<span class="n">pred_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prey_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_codes</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">pred_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_death</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>   
    <span class="n">prey_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total_reward</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>

<span class="c1"># Est. fitness</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>
<span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">model_codes</span><span class="p">],</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fitness&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Model code&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="c1"># Report</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The fitness was </span><span class="si">{fitness}</span><span class="s2"> (max score is {num_experiments*num_targets})&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="air-quotes.html" title="previous page">The Air Quotes Cognition - Lab</a>
    <a class='right-next' id="next-link" href="be-best.html" title="next page">Be best - Lab</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erik J Peterson<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>